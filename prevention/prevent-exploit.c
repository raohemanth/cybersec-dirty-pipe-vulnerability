#include <stdio.h>
#include <unistd.h>
#include <seccomp.h>
#include <linux/filter.h>
#include <linux/seccomp.h>
#include <errno.h>
int main() {

    printf("Initializing seccomp...\n");
    scmp_filter_ctx ctx = seccomp_init(SCMP_ACT_ALLOW); // Default action is to allow
    if (ctx == NULL) {
        printf("Failed to initialize seccomp\n");
        return -1;
    }

    printf("Adding rule to block 'splice' syscall...\n");
    int result = seccomp_rule_add(ctx, SCMP_ACT_ERRNO(EPERM), SCMP_SYS(splice), 0);
    if (result < 0) {
        printf("Failed to add rule to block 'splice'\n");
        seccomp_release(ctx);
        return -1;
    }

    printf("Loading seccomp filter...\n");
    result = seccomp_load(ctx);
    if (result < 0) {
        printf("Failed to load seccomp filter\n");
        seccomp_release(ctx);
        return -1;
    }

    printf("Seccomp filter loaded successfully. Continuing with the rest of the program...\n");


    printf("Releasing seccomp resources...\n");
    seccomp_release(ctx);
    printf("Seccomp resources released. Exiting program.\n");

    return 0;
}
